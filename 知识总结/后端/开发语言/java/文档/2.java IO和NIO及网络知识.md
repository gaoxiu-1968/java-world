# java IO，NIO及网络知识

## IO模型

### 同步阻塞IO

同步阻塞IO（Blocking IO），俗称BIO。

阻塞IO指的是需要内核IO彻底完成后，才返回到用户空间执行用户的操作。

<p style='color:red'>线程必须等待内核数据复制到用户内存</p>

### 同步非阻塞IO

（NO-Blocking IO）

非阻塞IO，指的是用户空间的程序不需要等待内核IO操作彻底完成，可以立即返回用户空间执行用户的操作，即处于非阻塞的状态，与此同时内核会立即返回给用户一个状态值。

<p style='color:red'>不断轮询内核，查看内核数据是否复制到了用户内存，这种模式会增加cpu性能的消耗</p>

### IO多路复用

即经典的Reactor反应器设计模式，有时也称为异步阻塞IO，java中的selector和Linux中的epoll就是这种模型。

<p style='color:red'>需要操作系统支持系统调用，不断轮询socket列表，查看数据是否准备就绪。</p>

也就是俗称的nio，java中的nio就是使用的这种模式，这种模式解决的是“线程等待时间”。

### 异步IO

（Asynchronous IO）

异步IO，指的是用户空间与内核空间的调用方式反过来。用户空间的线程变成被动接受者，而内核空间成了主动调用者。

## Reactor反应器设计模式

反应器模式由Reactor反应器线程、Handlers处理器两大角色组成：

（1）Reactor反应器线程的职责：负责响应IO事件，并且分发到Handlers处理器。

（2）Handlers处理器的职责：非阻塞的执行业务处理逻辑。

## java NIO

俗称异步非阻塞io，本质上读写还是阻塞的。

Java nio主要有三部分组成：

​	Channel（通道）

​	Buffer（缓存）

​	Selector（选择器）：屏蔽操作系统底层选择器的差异。

## 扩展

### 一台服务器理论上可以连接多少个客户端？

理论上一台服务器可以支撑无数个请求。

一台电脑上有65535个端口

### java理论上能建立多少个线程

java能创建的线程理论上是无限的，但是cpu的性能和内存是有限的，所以才会限制单台服务器的连接数。

### 为什么我们实际业务开发中使用不到NIO

我们实际中使用到的io开发，都是附件上传或下载，这大数据量的连接bio和nio的性能差不多。

而且对于文件，上传和下载也不推荐和应用服务器绑定，推荐使用专用的文件服务器。

### netty解决的是那部分问题？

netty是基于java nio开发的轮子，让我们更简单进行高并发的网络开发。

不过实际中我们一般不进行网络开发，也就是协议开发。

我们主要处理的是应用层中，协议到实际应用的业务问题。

传出层到协议的问题一般处理很少，都是底层框架去处理这些问题。

